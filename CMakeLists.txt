cmake_minimum_required(VERSION 3.6)

project("piwx")
set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wall")
set(CMAKE_C_FLAGS_DEBUG "${CMAKE_C_FLAGS_DEBUG} -g")
set(INSTALL_PREFIX ${CMAKE_INSTALL_PREFIX})
if (NOT DEFINED SHARE_PREFIX)
  set(SHARE_PREFIX share/piwx/)
endif (NOT DEFINED SHARE_PREFIX)
set(IMAGE_RESOURCES ${CMAKE_INSTALL_PREFIX}/${SHARE_PREFIX}wxicons)
set(FONT_RESOURCES ${CMAKE_INSTALL_PREFIX}/${SHARE_PREFIX}fonts)
configure_file(config.h.in config.h)

find_package(LibXml2 REQUIRED)
include_directories(piwx ${CMAKE_BINARY_DIR} ${LIBXML2_INCLUDE_DIR})
add_executable(piwx gfx.c wx.c config.c piwx.c)
target_link_libraries(piwx curl xml2 png jansson)

install(TARGETS piwx DESTINATION bin)
install(DIRECTORY wxicons/ DESTINATION share/piwx/wxicons)
install(DIRECTORY fonts/ DESTINATION share/piwx/fonts)
